#!/usr/bin/env php
<?php

/*
 * This file is part of fab-cli
 *
 * (c) Jeff Welch <whatthejeff@gmail.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

require_once __DIR__ . '/../vendor/autoload.php';

const FAB_VERSION = '1.0';
const FAB_NAME = 'fab-cli (fabify)';

function usage() {
  printf("Usage: %s [-h|--help] [-v|--version] command [arg...]\n", FAB_NAME);
  exit;
}

function version() {
  printf("%s: version %s\n", FAB_NAME, FAB_VERSION);
  exit;
}

function parseargs($argv) {
    $options = getopt('hv', array('help','version'));
    foreach ($options as $key => $value) {
        switch ($key) {
            case 'h':
            case 'help':
                usage();
                break;

            case 'v':
            case 'version':
                version();
                break;
        }
    }

    return $argv;
}

parseargs($argv);

$fab = new Fab\SuperFab();

while (false !== $buffer = fgets(STDIN, 1024)) {
    echo $fab->paint($buffer);
}
